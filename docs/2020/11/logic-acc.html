<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatibile" content="IE=edge" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="language" content="en" />
    <meta name="copyright" content="CC-BY 4.0" />
    <meta name="url" content="//kodumaro.cacilhas.info/2020/11/logic-acc.html" />
    <meta name="date" content="Nov. 04, 2020" />
    <meta name="search_date" content="2020-11-04" />
    <meta name="author" content="Arƒ•imedeœÇ MontegasppŒ± CacilhŒ±œÇ" />
    <meta property="og:site_name" content="Kodumaro" />
    <meta property="og:title" content="Accumulators in Declarative Logic Programming" />
    <meta property="og:url" content="//kodumaro.cacilhas.info/2020/11/logic-acc.html" />
    <meta property="og:image" content="//cacilhas.info/img/glider.png" />
    <meta property="article:author" content="Arƒ•imedeœÇ MontegasppŒ± CacilhŒ±œÇ" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Kavivanar" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto&amp;subset=latin-ext" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:i,bold&amp;subset=latin-ext" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto+Mono" />
    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/animate.min.css" />
    <link rel="stylesheet" href="/css/bootstrap-dropdownhover.min.css" />
    <link rel="stylesheet" href="/css/ie10-viewport-bug-workaround.css" />
    <link rel="stylesheet" href="/css/bootstrap-theme.min.css" />
    <link rel="stylesheet" href="/css/theme.css" />
    <link rel="stylesheet" href="/css/kodumaro.css" />
    <link rel="stylesheet" href="//cacilhas.info/css/cacilhas.css" />
    <title>Accumulators in Declarative Logic Programming</title>
    <link rel="icon" href="/img/favicon.ico" />
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
    <script src="//cacilhas.info/js/ie-emulation-modes-warning.js"></script>
    <script src="//cacilhas.info/js/jquery.min.js"></script>
    <script src="//cacilhas.info/js/bootstrap-dropdownhover.min.js"></script>
    <script src="//cacilhas.info/js/handle-old-url.js"></script>
    <script src="//cacilhas.info/js/alt-title.js"></script>
    <script src="//cacilhas.info/js/anchors.js"></script>
    <script async="async" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-5741846017654057",
        enable_page_level_ads: true,
      })
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date;a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,"script","https://www.google-analytics.com/analytics.js","ga")
      ga("create", "UA-99357497-1", "auto")
      ga("send", "pageview")
    </script>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" type="button" data-togge="collapse" data-target="#navbar" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="dropdown">
            <span class="navbar-brand dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">‚Ñ≠acilhŒ±œÇ.INFO</span>
            <ul class="dropdown-menu">
              <li><a href="//cacilhas.info/"><i class="glyphicon glyphicon-home"></i>&nbsp;‚Ñ≠acilhŒ±œÇ.INFO</a></li>
              <li><a href="//kodumaro.cacilhas.info/"><i class="licon icon-kodumaro"></i>&nbsp;Kodumaro</a></li>
              <li><a href="//montegasppa.cacilhas.info/"><i class="licon icon-montegasppa"></i>&nbsp;‚Ñ≥ontegasppŒ± and Giulia C.‚Äôs Thoughts</a></li>
              <li><hr/></li>
              <li><a href="//hondaj.cacilhas.info/" target="_blank"><i class="licon icon-hondaj"></i>&nbsp;ƒ§√∏≈ÖƒêŒîjÃÜ‚ÇÄ</a></li>
              <li><a href="//vortaro.cacilhas.info/" target="_blank"><i class="glyphicon glyphicon-link"></i>&nbsp;&#x2F;&#x2F;vortaro.cacilhas.info&#x2F;</a></li>
              <li><a href="https://claudiotorcato.wordpress.com/" target="_blank"><i class="licon icon-wordpress"></i>&nbsp;Mosaico Livre</a></li>
              <li><a href="https://www.patreon.com/cacilhas" target="_blank"><i class="licon icon-patreon"></i>&nbsp;‚Ñ≥ontegasppŒ±</a></li>
              <li><a href="https://montegasppa.bandcamp.com/releases" target="_blank"><i class="licon icon-le-obscur-essentes"></i>&nbsp;Le Obscur EssenteœÇ</a></li>
              <li><a href="https://www.todasfridas.com.br/" target="_blank"><i class="licon icon-fridas"></i>&nbsp;Todas Fridas</a></li>
              <li><a href="https://waltercruz.com/" target="_blank"><i class="glyphicon glyphicon-link"></i>&nbsp;Walter Cruz</a></li>
              <li><a href="https://dev.to/cacilhas" target="_blank"><i class="licon icon-dev-to"></i>&nbsp;DEV Profile üë©‚Äçüíªüë®‚Äçüíª</a></li>
            </ul>
          </div>
        </div>
        <div class="collapse navbar-collapse" id="navbar">
          <ul class="nav navbar-nav">
            <li><a href="//kodumaro.cacilhas.info"><i class="glyphicon glyphicon-home"></i>&nbsp;Home</a></li>
            <li class="active"><a href="//kodumaro.cacilhas.info/2020/11/logic-acc.html">Accumulators in Declarative Logic Programming</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h2 class="mg-title">Accumulators in Declarative Logic Programming</h2>
          <h6 class="pull-right">2020-11-04</h6>
          <h6>The shadows behind the code.</h6>
        </div>
        <div class="panel-body">
          <p class="pull-right" > <img src="//cacilhas.info/img/glider.png" alt="Logic" /></p>
<p class="mg-first" > This post is a translation of an <a href="/2017/11/acumuladores.html">older one</a>.</p>
<p><a href="https://en.wikipedia.org/wiki/Declarative_programming">Declarative</a> <a href="https://en.wikipedia.org/wiki/Logic_programming">Logic</a> Programming is a quite alien paradigm
for other paradigm pogrammers.</p>
<p>The most popular paradigm is the Imperative Programming (it has changed), which
consists of ordering statements that the computer system must perform in
sequence, respecting flow changes. It‚Äôs as close as possible to the
microprogram.</p>
<p>However, standing in a creation and management sight, Imperative Programming‚Äôs
far from efficient, leads to hard-mantaining codes, much bug-denser than any
other paradigm.</p>
<p>A rival paradigm that‚Äôs gaining ground is the
<a href="https://en.wikipedia.org/wiki/Functional_programming">Function Programming</a>, based on <a href="https://en.wikipedia.org/wiki/Lambda_calculus">Œª-calculus</a>, that
takes advantage of some constraints to solve integrity issues.</p>
<p>Beyond those paradigms, there are a lot more, notable two:</p>
<ul>
<li>The Declarative Programming: doesn‚Äôt express the algorithms by the control
flow, but instead by declaring a facts domain.</li>
<li>The Logic Programming: largely based on formal logic.</li>
</ul>
<p>The Logic Programming barely exists apart from Declarative Programming, and
gives birth to a large intersection named <strong>Declarative Logic Programming</strong>.</p>
<p>While in Imperative Programming one orders statements to the machine, in the
Declarative Logic Programming one defines a facts domain and the logical
relations between clauses.</p>
<p>No ‚Äúorder‚Äù is give to the system, instead queries are asked. The aftermath of
the system trying to figure out the answers is the expected program behaviour.</p>
<p>The behaviour varies from I/O side-effects to domain changes itself.</p>
<p>Let‚Äôs take <a href="https://www.swi-prolog.org/">Prolog</a> as reference: Prolog has four types of clauses:
<a href="http://www.ablmcc.edu.hk/~scy/prolog/pro02.htm">facts, rules, goals, and queries</a>.</p>
<p><strong>Facts</strong> are self-sufficient truths, they don‚Äôt depend on other facts or rules.
For instance, ‚ÄúAnna and Bob are friends,‚Äù that can be represented as following:</p>
<pre class="prettyprint"><code class="prolog language-prolog">friend(anna, bob).</code></pre>
<p><strong>Rules</strong> depend on facts or other rules to validate whether it‚Äôs true. For
instance:</p>
<pre class="prettyprint"><code>sunny(Today) :- \+ raining(Today).</code></pre>
<p>Today is sunny if it‚Äôs not (<code>\+</code>) raining.</p>
<p><strong>Goal</strong> is the target query, with no variables. <strong>Query</strong> is any question asked
to the system, with variables or not.</p>
<p>A query may be true, false, or give multiple answers depending on the variable
values. The goal must have a truthful answer, returning a failure status
otherwise.</p>
<h3 id="fibonacci">Fibonacci</h3>
<p>Let‚Äôs define the Fibonacci numbers now.</p>
<p>It‚Äôs required the two first values (indexes 0 and 1) to equal 1. One represents
it in Prolog like this:</p>
<pre class="prettyprint"><code class="prolog language-prolog">fibonacci(0, 1).
fibonacci(1, 1).</code></pre>
<p>The step is defined as the sum of its two predecessors. It‚Äôs valid to call the
current value <code>N</code> and its predecessors <code>N1</code> and <code>N2</code>:</p>
<pre class="prettyprint"><code class="prolog language-prolog">fibonacci(N, R) :- succ(N1, N),
                   succ(N2, N1),
                   fibonacci(N1, R1),
                   fibonacci(N2, R2),
                   plus(R1, R2, R).</code></pre>
<p>This is a valid implementation, but with a serious stack overflow issue.
<a href="http://wiki.c2.com/?TailCallOptimization">TCO</a> is needed for solving it.</p>
<p>Let‚Äôs define two rules: the main one calling an auxiliary one. The auxiliary
rule uses accumulators to transport the result:</p>
<pre class="prettyprint"><code class="prolog language-prolog">fibonacci(N, R) :- N &gt;= 0,
                   fibonacci(N, 0, 1, R).

fibonacci(0, _, R, R) :- !.
fibonacci(N, A, B, R) :- succ(N1, N),
                         plus(A, B, AB),
                         fibonacci(N1, B, AB, R).</code></pre>
<p>The <code>fibonacci/2</code> is the main rule; <code>fibonacci/4</code> is the auxiliary one, it takes
the index (<code>N</code>), two accumulators (<code>A</code> and <code>B</code>), and the result (<code>R</code>).</p>
<p>Since the last call is <code>fibonacci/4</code>, it takes advantage of TCO.</p>
<h3 id="definite-clause-grammar">Definite clause grammar</h3>
<p><a href="https://www.swi-prolog.org/pldoc/man?section=DCG">Definite clause grammar</a> (DCG) is a way for expressing natural and formal
grammar in Prolog. It uses the <code>--&gt;/2</code> clause as a syntax sugar for grammar
clearance.</p>
<p>Shallowly it omits the last two parameters, creating a chaining of clauses.</p>
<p>The <code>fibonacci//2</code> becomes something like:</p>
<pre class="prettyprint"><code class="prolog language-prolog">fibonacci(0, _) --&gt; '=', !.
fibonacci(N, A) --&gt; { succ(N1, N) },
                    call(\B^B^B^(true), B),
                    plus(A),
                    fibonacci(N1, B).</code></pre>
<p>The curly brackets are used to define the <code>N1</code> as <code>N</code>‚Äôs predecessor without
change the chain. The <code>call//2</code> (<code>call/4</code>) uses a lambda to define <code>B</code> as the
first implicit parameter.</p>
<p>After that, the <code>A</code> value is added to the first implicit parameter.</p>
<p>Finally, the recursion is called passing the predecessor, the original first
parameter, followed by the current implicit parameters.</p>
<p>You can try the following query:</p>
<pre class="prettyprint"><code class="prolog language-prolog">forall(between(0, 10, X), (fibonacci(X, F), writeln({X, F}))).</code></pre>
<p>For some DCG magics, look at the <a href="http://www.pathwayslms.com/swipltuts/dcg/">Anne Ogborn tutorial</a>.</p>
<hr />
<p>For curiosity, the DCG above expands to:</p>
<pre class="prettyprint"><code class="prolog language-prolog">fibonacci(0, _, `_1`, `_R`) :- `_1` = `_R`, !.
fibonacci(N, A, `_1`, `_R`) :- succ(N1, N),
                               call(\B^B^B^(true), B, `_1`, `_2`),
                               plus(A, `_2`, `_3`),
                               fibonacci(N1, B, `_3`, `_R`).</code></pre>
<hr />
<p class="small" > Also in <a href="https://dev.to/cacilhas/accumulators-in-declarative-logic-programming-5cl7">DEV Community üë©‚Äçüíªüë®‚Äçüíª</a>.</p>
        </div>
        <div id="tags" class="pull-right tags">
          <script>
            var tags = 'concept logic prolog'
            if (tags) {
              var first = true
              for (var tag of tags.split(" ")) {
                if (first) { first = false }
                else $('#tags').append('&nbsp;|&nbsp;')
                $('#tags').append(
                  '<a href="/?tag=' + tag + '" class="tag">' + tag.replace(/-/g, ' ') + '</a>'
                )
              }
            }
          </script>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-body">
          <div id="disqus_thread">
            <noscript>
              Please enable JavaScript to view the comments
              <a href="https://disqus.com/?ref_noscript">powered by Disqus</a>.
            </noscript>
          </div>
          <script>
            var disqus_config = function() {
              this.page = this.page || {}
              this.page.url = 'https://kodumaro.cacilhas.info/2020/11/logic-acc.html'
              this.page.identifier = '_source.posts.2020-11-04-logic-acc'
              this.page.title = 'Accumulators in Declarative Logic Programming'
            }
            $(document).ready(function() {
              var d = document, s = d.createElement('script')
              s.src = 'https://kodumaro.disqus.com/embed.js'
              s.setAttribute('data-timestamp', +new Date())
              ;(d.head || d.body).appendChild(s)
            })
          </script>
        </div>
      </div>
      <div>
        <div class="pull-left">
          <script async="async" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px;"
               data-ad-client="ca-pub-5741846017654057" data-ad-slot=""></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({})</script>
        </div>
      </div>
    </div>
    <div class="panel-footer" id="footer">
      <p class="pull-left small">
        <a href="https://dev.to/cacilhas">
          <img src="https://d2fltix0v2e0sb.cloudfront.net/dev-badge.svg"
               alt="DEV Profile üë©‚Äçüíªüë®‚Äçüíª"
               height="30" width="30"
               style="vertical-align: middle; border: none;" />
        </a>
      </p>
      <p class="small">
        Arƒ•imedeœÇ MontegasppŒ± CacilhŒ±œÇ
        &nbsp;
        <a ref="license" href="http://creativecommons.org/licenses/by/4.0/deed">
          <img rel="license"
               alt="CC-BY 4.0"
               src="https://i.creativecommons.org/l/by/4.0/80x15.png"
               style="vertical-align: middle; border: none;" />
        </a>
      </p>
    </div>
    <script src="//cacilhas.info/js/bootstrap.min.js"></script>
    <script src="//cacilhas.info/js/ie10-viewport-bug-workaround.js"></script>
    <script language="javascript">
      $(document).ready(function() {
        $('[title]').tooltip();
      })
    </script>
  </body>
</html>
